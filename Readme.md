# Air-Separation

This project simulates an air separation (oxygen production) plant by orchestrating a PRO/II process simulation via Python (COM automation). It enables data extraction, sensitivity analysis, and optimization of key operating variables.

For background and methodology, see: [First Paper](https://www.sciencedirect.com/science/article/pii/S2405896321010685) and [Second Paper](https://pubs.acs.org/doi/full/10.1021/acsomega.1c06669).

## Repository structure
- `Air_Separation.py`: Python script that connects to PRO/II through COM, loads the case, inspects objects/attributes, runs calculations, and generates a report.
- `Casebook_Air_Separation_Plant.prz`: PRO/II casebook (project) file used by the script.
- `Casebook_Air_Separation_Plant.inp`: PRO/II input file imported by the script.
- `A8_Air_Separation_Plant.prz`, `Air_Separation_Bryan.prz`: Additional PRO/II project variants (optional/legacy).
- `Readme.md`: Project documentation.

## Prerequisites
- Windows OS (COM automation)
- Installed and licensed PRO/II (tested with SimSci/AVEVA PRO/II; ensure the Database COM server `SimSciDbs.Database.102` is available)
- Python 3.8+ on Windows
- Python packages: `pywin32`, `numpy`

Install Python dependencies:
```bash
pip install pywin32 numpy
```

## Usage
1. Ensure PRO/II is installed and you can open `Casebook_Air_Separation_Plant.prz` manually.
2. Update the `db_path` in `Air_Separation.py` to point to the `.prz` file on your machine. Example:
   ```python
   db_path = r"C:\\Users\\<you>\\Documents\\Air-Separation\\Casebook_Air_Separation_Plant.prz"
   ```
3. Run the script from PowerShell or CMD:
   ```bash
   python Air_Separation.py
   ```
4. The script will:
   - Initialize the PRO/II COM server
   - Import the `.inp` into the project
   - Open the database from `db_path`
   - Acquire a security seat
   - Enumerate example classes/objects/attributes
   - Run calculations and generate a report
   - Release the security seat and close

Output artifacts (report files) are generated by PRO/II in the same directory as the project unless configured otherwise.

## Configuration notes
- If your PRO/II installation registers a different COM ProgID (e.g., `SimSciDbs.Database.110`), update the dispatch string in `Air_Separation.py`:
  ```python
  win32.Dispatch("SimSciDbs.Database.110")
  ```
- The script currently expects the `.inp` with the same stem path as `db_path`. Ensure `Casebook_Air_Separation_Plant.inp` exists next to the `.prz`.

## Extending: Sensitivity and optimization
The repository includes the basic wiring to control and query PRO/II. To add sensitivity analysis and optimization:
- Identify decision variables and KPIs via `ActivateObject(...).Get/SetAttribute*` APIs
- Loop over variable grids or use an optimizer (e.g., `scipy`, `nevergrad`) to call `RunCalcs` and record KPIs
- Persist results to CSV/Parquet and visualize with `matplotlib`/`seaborn`

## Troubleshooting
- COM dispatch fails: verify PRO/II is installed and the COM server ProgID matches. Run Python as Administrator if needed.
- License/seat errors: ensure you have available PRO/II licenses; the script requests a security seat (`GetSecuritySeat(2)`).
- File not found: check `db_path` and that `.prz` and `.inp` are accessible.

## Citation
If you use this repository, please cite the associated work (see the paper linked above).
